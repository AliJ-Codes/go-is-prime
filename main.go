package main

import (
	"fmt"
	"runtime"
	"sync"
	"time"
)

func is_prime(numbers <-chan int, ii int, wg *sync.WaitGroup) {
	defer wg.Done()
	for number := range numbers {
		s := true
		for i := 2; i < number; i++ {
			if number%i == 0 {
				s = false
				break
			}
		}
		if s {
			fmt.Println("Worker", ii, "resualt:", number, "is prime")
		}
	}
}
func main() {
	var wg sync.WaitGroup
	numChan := make(chan int, 50)
	numbers := []int{
		1000000007, 1000000009, 1000000021, 1000000033, 1000000087,
		1000000093, 1000000097, 1000000103, 1000000123, 1000000181,
		1000000207, 1000000223, 1000000241, 1000000271, 1000000289,
		1000000297, 1000000321, 1000000349, 1000000363, 1000000403,
		1000000409, 1000000411, 1000000433, 1000000439, 1000000447,
		1000000453, 1000000459, 1000000483, 1000000513, 1000000531,
		1000000579, 1000000607, 1000000613, 1000000637, 1000000663,
		1000000669, 1000000679, 1000000691, 1000000693, 1000000709,
		1000000729, 1000000733, 1000000739, 1000000747, 1000000751,
		1000000787, 1000000799, 1000000811, 1000000841, 1000000853,
		1000000867, 1000000871, 1000000891, 1000000901, 1000000919,
		1000000931, 1000000933, 1000000993, 1000001011, 1000001021,
		1000001053, 1000001087, 1000001099, 1000001137, 1000001161,
		1000001203, 1000001213, 1000001237, 1000001263, 1000001269,
		1000001273, 1000001279, 1000001311, 1000001329, 1000001333,
		1000001351, 1000001363, 1000001369, 1000001381, 1000001387,
		1000001389, 1000001393, 1000001413, 1000001447, 1000001449,
		1000001491, 1000001501, 1000001531, 1000001537, 1000001539,
		1000001581, 1000001617, 1000001621, 1000001633, 1000001647,
		1000001661, 1000001677, 1000001699, 1000001759, 1000001773,
		1000001789, 1000001791, 1000001801, 1000001803, 1000001819,
		1000001857, 1000001887, 1000001917, 1000001927, 1000001951,
		1000001963, 1000001969, 1000001983, 1000002017, 1000002029,
		1000002043, 1000002049, 1000002073, 1000002091, 1000002103,
		1000002109, 1000002121, 1000002143, 1000002149, 1000002161,
		1000002163, 1000002181, 1000002187, 1000002191, 1000002193,
		1000002233, 1000002241, 1000002251, 1000002263, 1000002277,
		1000002287, 1000002323, 1000002331, 1000002341, 1000002353,
		1000002359, 1000002361, 1000002367, 1000002377, 1000002389,
		1000002397, 1000002409, 1000002413, 1000002419, 1000002421,
		1000002433, 1000002449, 1000002457, 1000002469, 1000002473,
		1000002481, 1000002491, 1000002509, 1000002527, 1000002551,
		1000002553, 1000002563, 1000002571, 1000002589, 1000002593,
		1000002611, 1000002617, 1000002623, 1000002631, 1000002637,
		1000002649, 1000002653, 1000002673, 1000002677, 1000002689,
		1000002697, 1000002701, 1000002703, 1000002721, 1000002727,
		1000002731, 1000002739, 1000002749, 1000002751, 1000002767,
		1000002779, 1000002797, 1000002801, 1000002813, 1000002827,
		1000002833, 1000002847, 1000002851, 1000002857, 1000002869,
		1000002871, 1000002887, 1000002899, 1000002901, 1000002913,
		1000002917, 1000002929, 1000002941, 1000002943, 1000002947,
		1000002959, 1000002973, 1000002989, 1000003001, 1000003009,
		1000003013, 1000003027, 1000003039, 1000003049, 1000003061,
		1000003069, 1000003079, 1000003087, 1000003091, 1000003093,
		1000003109, 1000003111, 1000003123, 1000003133, 1000003147,
		1000003159, 1000003163, 1000003181, 1000003187, 1000003193,
		1000003201, 1000003211, 1000003217, 1000003223, 1000003231,
	}
	start := time.Now()

	for i := 1; i <= runtime.NumCPU(); i++ {
		wg.Add(1)
		go is_prime(numChan, i, &wg)
	}
	wg.Add(1)
	go func() {
		for _, number := range numbers {
			numChan <- number
		}
		close(numChan)
		wg.Done()
	}()
	wg.Wait()
	end := time.Since(start)
	fmt.Println("CPU cores:", runtime.NumCPU())
	fmt.Println("Prosses time:", end)

}
